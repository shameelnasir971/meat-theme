{% comment %}
  MS Pro Collection Circles - No Limit Version
{% endcomment %}

{% style %}
  /* Import Requested Fonts */
  @import url('https://fonts.googleapis.com/css2?family=Questrial&family=Oswald:wght@400;500;600;700&family=Poppins:wght@300;400;500;600&display=swap');

  .ms-wrap-{{ section.id }} {
    /* --- Dynamic Variables --- */
    --bg-color: {{ section.settings.bg_color }};
    --primary-color: {{ section.settings.primary_color }};
    --inner-bg: {{ section.settings.inner_bg_color }};
    --text-color: {{ section.settings.text_color }};
    
    --font-family: {{ section.settings.font_family }};
    --text-size: {{ section.settings.text_size }}px;
    --text-size-mob: {{ section.settings.text_size_mob }}px;
    
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    background-color: var(--bg-color);
  }

  .ms-flex-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    flex-wrap: wrap; /* Items will wrap to next line if many */
    gap: 30px;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }

  .ms-circle-box {
    text-align: center;
    width: 160px;
    text-decoration: none;
    display: block;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    cursor: pointer;
    
    /* Entrance Animation */
    {% if section.settings.animation_type == 'fade-up' %}
      animation: fadeInUp 1s ease-out forwards;
      opacity: 0;
    {% elsif section.settings.animation_type == 'zoom-in' %}
      animation: zoomIn 0.8s ease-out forwards;
      opacity: 0;
    {% endif %}
  }
  
  /* Stagger Delay for Animation (First 10 items) */
  .ms-circle-box:nth-child(1) { animation-delay: 0.1s; }
  .ms-circle-box:nth-child(2) { animation-delay: 0.15s; }
  .ms-circle-box:nth-child(3) { animation-delay: 0.2s; }
  .ms-circle-box:nth-child(4) { animation-delay: 0.25s; }
  .ms-circle-box:nth-child(5) { animation-delay: 0.3s; }
  .ms-circle-box:nth-child(6) { animation-delay: 0.35s; }
  .ms-circle-box:nth-child(n+7) { animation-delay: 0.4s; }

  /* Outer Border - Perfect Circle */
  .ms-outer-ring {
    width: 150px;
    height: 150px;
    border: 1px solid var(--primary-color);
    border-radius: 50%;
    padding: 8px;
    margin: 0 auto 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    background: #fff;
  }

  /* Inner Background - Perfect Circle */
  .ms-inner-fill {
    width: 100%;
    height: 100%;
    background-color: var(--inner-bg);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden; 
    position: relative;
  }

  /* Image Display Logic */
  .ms-inner-fill img {
    width: 85%;
    height: 85%;
    object-fit: contain; 
    border-radius: 50%; 
    transition: transform 0.4s ease;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.12));
  }

  .ms-title-text {
    font-family: var(--font-family);
    color: var(--text-color);
    font-size: var(--text-size);
    font-weight: 600;
    margin: 0;
    text-transform: capitalize;
    line-height: 1.2;
    transition: 0.3s;
  }

  /* Hover Effects */
  .ms-circle-box:hover .ms-outer-ring {
    {% if section.settings.enable_hover %}
      transform: translateY(-10px);
      box-shadow: 0 15px 30px rgba(0,0,0,0.1);
      border-color: var(--text-color);
    {% endif %}
  }

  .ms-circle-box:hover img {
    {% if section.settings.enable_hover %}
      transform: scale(1.15);
    {% endif %}
  }
  
  .ms-circle-box:hover .ms-title-text {
    color: var(--primary-color);
  }

  /* Keyframes */
  @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes zoomIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

  /* Mobile Responsive */
  @media (max-width: 768px) {
    .ms-flex-container { gap: 15px; }
    .ms-circle-box { width: 130px; }
    .ms-outer-ring { width: 120px; height: 120px; padding: 6px; }
    .ms-title-text { font-size: var(--text-size-mob); }
  }

  @media (max-width: 480px) {
    .ms-circle-box { width: 45%; }
    .ms-outer-ring { width: 110px; height: 110px; }
  }
{% endstyle %}

<div class="ms-wrap-{{ section.id }}">
  <div class="ms-flex-container">
    
    {%- assign collection = section.settings.collection -%}

    {% if collection != blank %}
      {% comment %} --- LIVE COLLECTION MODE (NO LIMIT) --- {% endcomment %}
      {% for product in collection.products %}
        <div class="ms-circle-box" onclick="filterMeatProducts('{{ product.title | escape }}')">
          <div class="ms-outer-ring">
            <div class="ms-inner-fill">
              <img src="{{ product.featured_image | img_url: '400x400', crop: 'center' }}" 
                   alt="{{ product.title }}" 
                   loading="lazy">
            </div>
          </div>
          <h3 class="ms-title-text">{{ product.title }}</h3>
        </div>
      {% endfor %}

    {% else %}
      {% comment %} --- DEMO MODE (Shows 5 Meat Categories) --- {% endcomment %}
      {% assign names = "Beef,Goat,Duck,Steak,Veal" | split: "," %}
      {% assign imgs = "https://images.rawpixel.com/image_png_800/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIzLTA4L3Jhd3BpeGVsX29mZmljZV8yNV9waG90b19vZl9yYXdfYmVlZl9zdGVha19pc29sYXRlZF9vbl93aGl0ZV9iYWNrZ19kOTY0ZDAxYy1mOTZmLTQ5OWYtYmQxMC1jOTRkYjc0ZGI2N2JfMS5wbmc.png,https://static.vecteezy.com/system/resources/previews/027/215/121/non_2x/raw-lamb-meat-isolated-on-transparent-background-png.png,https://static.vecteezy.com/system/resources/previews/021/665/596/non_2x/meat-duck-breast-isolated-on-white-background-generative-ai-png.png,https://static.vecteezy.com/system/resources/previews/019/607/547/non_2x/beef-steak-isolated-on-transparent-background-free-png.png,https://static.vecteezy.com/system/resources/previews/024/534/496/non_2x/fresh-raw-meat-on-transparent-background-free-png.png" | split: "," %}

      {% for i in (0..4) %}
        <div class="ms-circle-box" onclick="filterMeatProducts('{{ names[i] }}')">
          <div class="ms-outer-ring">
            <div class="ms-inner-fill">
              <img src="{{ imgs[i] }}" alt="{{ names[i] }}">
            </div>
          </div>
          <h3 class="ms-title-text">{{ names[i] }}</h3>
        </div>
      {% endfor %}
    {% endif %}

  </div>
</div>

{% schema %}
{
  "name": "MS Meat Collection Nav",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection",
      "info": "Leave empty to show Demo Items"
    },
    
    {
      "type": "header",
      "content": "Typography Settings"
    },
    { "type": "select", "id": "font_family", "label": "Font Family", "options": [
      { "value": "'Oswald', sans-serif", "label": "Oswald (Bold)" },
      { "value": "'Questrial', sans-serif", "label": "Questrial (Clean)" },
      { "value": "'Poppins', sans-serif", "label": "Poppins (Modern)" },
      { "value": "serif", "label": "System Serif" }
    ], "default": "'Oswald', sans-serif" },
    { "type": "range", "id": "text_size", "label": "Text Size (Desktop)", "min": 14, "max": 30, "default": 22, "unit": "px" },
    { "type": "range", "id": "text_size_mob", "label": "Text Size (Mobile)", "min": 12, "max": 24, "default": 18, "unit": "px" },

    {
      "type": "header",
      "content": "Color Settings"
    },
    {
      "type": "color", "id": "bg_color", "label": "Section Background", "default": "#ffffff"
    },
    {
      "type": "color", "id": "primary_color", "label": "Ring Border Color", "default": "#b91c1c"
    },
    {
      "type": "color", "id": "inner_bg_color", "label": "Circle Inner Background", "default": "#fff5f5"
    },
    {
      "type": "color", "id": "text_color", "label": "Text Color", "default": "#b91c1c"
    },

    {
      "type": "header",
      "content": "Animations & Hover"
    },
    { "type": "select", "id": "animation_type", "label": "Entrance Animation", "options": [
      { "value": "none", "label": "None" },
      { "value": "fade-up", "label": "Fade Up" },
      { "value": "zoom-in", "label": "Zoom In" }
    ], "default": "fade-up" },
    { "type": "checkbox", "id": "enable_hover", "label": "Enable Hover Zoom & Lift", "default": true },

    {
      "type": "header",
      "content": "Layout Spacing"
    },
    {
      "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Top", "default": 60
    },
    {
      "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding Bottom", "default": 60
    }
  ],
  "presets": [
    {
      "name": "MS Meat Collection Nav"
    }
  ]
}
{% endschema %}