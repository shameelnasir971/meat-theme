{% comment %}
MS Pro Categories - Collection Based Dynamic Mode

User selects a Collection from Theme Settings.

Products in that collection become Category Cards.

Product Image = Card Image.

Product Title = Category Name & Filter Keyword.

UI Matches Screenshot Exactly.
{% endcomment %}

{% style %}
@import url('https://fonts.googleapis.com/css2?family=Oswald:wght@600;700&display=swap');

.section-{{ section.id }}-padding {
padding-top: {{ section.settings.padding_top }}px;
padding-bottom: {{ section.settings.padding_bottom }}px;
background-color: {{ section.settings.bg_color }};
}

.ms-cat-container {
max-width: {{ section.settings.container_width }}px;
margin: 0 auto;
padding: 0 20px;
}

/* Section Heading */
.ms-section-heading {
text-align: center;
font-family: 'Oswald', sans-serif;
font-size: clamp(30px, 4vw, 42px);
font-weight: 700;
color: {{ section.settings.heading_color }};
margin-bottom: 45px;
text-transform: capitalize;
letter-spacing: 0.5px;
}

/* Grid Layout */
.ms-cat-grid {
display: grid;
grid-template-columns: repeat(4, 1fr);
gap: 25px;
}

/* Rectangular Card Style */
.ms-cat-card {
position: relative;
height: 300px; /* Fixed Height matching screenshot feel */
border-radius: 12px;
overflow: hidden;
cursor: pointer;
box-shadow: 0 4px 15px rgba(0,0,0,0.08);
transition: transform 0.3s ease, box-shadow 0.3s ease;
background-color: #f0f0f0;
display: block;
}

.ms-cat-card:hover {
transform: translateY(-6px);
box-shadow: 0 15px 30px rgba(0,0,0,0.15);
}

/* Image Style */
.ms-cat-img {
width: 100%;
height: 100%;
object-fit: cover;
transition: transform 0.6s ease;
display: block;
}

.ms-cat-card:hover .ms-cat-img {
transform: scale(1.08);
}

/* SVG Placeholder */
.ms-cat-card svg {
width: 100%;
height: 100%;
background: #e0e0e0;
object-fit: cover;
transition: transform 0.6s ease;
}
.ms-cat-card:hover svg { transform: scale(1.08); }

/* Dark Gradient Overlay */
.ms-cat-overlay {
position: absolute;
bottom: 0;
left: 0;
width: 100%;
height: 60%;
background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.4) 50%, rgba(0,0,0,0) 100%);
pointer-events: none;
z-index: 1;
}

/* Text Style - Bottom Left */
.ms-cat-title {
position: absolute;
bottom: 25px;
left: 25px;
font-family: 'Oswald', sans-serif;
color: #ffffff;
font-size: 30px;
font-weight: 700;
text-transform: uppercase;
margin: 0;
text-shadow: 0 2px 10px rgba(0,0,0,0.5);
z-index: 2;
line-height: 1;
letter-spacing: 1px;
}

/* Responsive Design */
@media (max-width: 1024px) {
.ms-cat-grid {
grid-template-columns: repeat(2, 1fr);
}
.ms-cat-card {
height: 260px;
}
}

@media (max-width: 600px) {
.ms-cat-grid {
grid-template-columns: 1fr;
}
.ms-cat-card {
height: 240px;
}
.ms-section-heading {
margin-bottom: 30px;
}
}
{% endstyle %}

<div class="section-{{ section.id }}-padding">
  <div class="ms-cat-container">

    {% if section.settings.heading != blank %}
      <h2 class="ms-section-heading">{{ section.settings.heading }}</h2>
    {% endif %}

    <div class="ms-cat-grid">
      
      {%- assign selected_collection = section.settings.collection -%}

      {%- if selected_collection != blank and selected_collection.products_count > 0 -%}
        
        <!-- DYNAMIC LOOP: Collection ke products ko Card bana diya -->
        {%- for product in selected_collection.products limit: section.settings.limit -%}
          <!-- 
             ONCLICK UPDATE: Ab ye dusre page (collections/all) par bhejega ?category parameter ke sath
          -->
          <div class="ms-cat-card" onclick="window.location.href='/collections?category={{ product.title | url_encode }}'">
            
            {%- if product.featured_image != blank -%}
              <img 
                src="{{ product.featured_image | img_url: '600x600', crop: 'center' }}" 
                alt="{{ product.title }}" 
                class="ms-cat-img" 
                loading="lazy"
                width="300"
                height="300"
              >
            {%- else -%}
              {{ 'product-' | append: forloop.index | placeholder_svg_tag: 'ms-cat-img' }}
            {%- endif -%}

            <div class="ms-cat-overlay"></div>
            <h3 class="ms-cat-title">{{ product.title }}</h3>
          </div>
        {%- endfor -%}

      {%- else -%}
        
        <!-- FALLBACK UI: Agar collection select nahi ki to ye dikhega -->
        {% assign default_cats = "Beef,Goat,Duck,Chicken" | split: ',' %}
        {% for cat in default_cats %}
          <div class="ms-cat-card" onclick="window.location.href='/collections?category={{ cat | url_encode }}'">
            {{ 'collection-' | append: forloop.index | placeholder_svg_tag: 'ms-cat-img' }}
            <div class="ms-cat-overlay"></div>
            <h3 class="ms-cat-title">{{ cat }}</h3>
          </div>
        {% endfor %}

      {%- endif -%}

    </div>
  </div>
</div>


{% schema %}
{
"name": "Shop By Category",
"settings": [
{
"type": "text",
"id": "heading",
"label": "Heading",
"default": "Shop By Category"
},
{
"type": "header",
"content": "Data Source"
},
{
"type": "collection",
"id": "collection",
"label": "Select Collection",
"info": "Products inside this collection will display as Category Cards."
},
{
"type": "range",
"id": "limit",
"min": 4,
"max": 12,
"step": 1,
"label": "Limit Cards",
"default": 4
},
{
"type": "header",
"content": "Layout Settings"
},
{
"type": "range",
"id": "container_width",
"min": 1000,
"max": 1600,
"step": 10,
"unit": "px",
"label": "Container Width",
"default": 1400
},
{
"type": "range",
"id": "padding_top",
"min": 0,
"max": 100,
"step": 5,
"unit": "px",
"label": "Padding Top",
"default": 60
},
{
"type": "range",
"id": "padding_bottom",
"min": 0,
"max": 100,
"step": 5,
"unit": "px",
"label": "Padding Bottom",
"default": 60
},
{
"type": "header",
"content": "Colors"
},
{
"type": "color",
"id": "bg_color",
"label": "Background Color",
"default": "#ffffff"
},
{
"type": "color",
"id": "heading_color",
"label": "Heading Color",
"default": "#1a1a1a"
}
],
"presets": [
{
"name": "Shop By Category"
}
]
}
{% endschema %}