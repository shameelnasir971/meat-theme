{%- style -%}
/* Import Requested Fonts */
@import url('https://fonts.googleapis.com/css2?family=Questrial&family=Oswald:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap');

.menu-board-{{ section.id }} {
  padding: {{ section.settings.padding_top }}px 0 {{ section.settings.padding_bottom }}px;
  background-color: {{ section.settings.bg_color }};
  color: {{ section.settings.text_color }};
  overflow: hidden;
}

.mb-container {
  max-width: {{ section.settings.container_width }}px;
  margin: 0 auto;
  padding: 0 20px;
}

/* Heading Styling */
.mb-header h2 {
  text-align: {{ section.settings.heading_align }};
  font-family: {{ section.settings.heading_font }};
  font-size: {{ section.settings.title_size }}px;
  font-weight: {{ section.settings.heading_weight }};
  color: {{ section.settings.title_color }};
  margin-bottom: {{ section.settings.heading_margin }}px;
  text-transform: uppercase;
  letter-spacing: {{ section.settings.heading_spacing }}px;
}

/* Tabs Styling */
.mb-tabs {
  display: flex;
  justify-content: center;
  gap: {{ section.settings.tab_gap }}px;
  margin-bottom: 50px;
  flex-wrap: wrap;
}

.mb-tab-btn {
  padding: 10px 25px;
  border: 1px solid {{ section.settings.tab_border_color }};
  background: transparent;
  color: {{ section.settings.tab_text_color }};
  border-radius: {{ section.settings.tab_radius }}px;
  cursor: pointer;
  font-family: {{ section.settings.body_font }};
  font-weight: 600;
  transition: all 0.3s ease;
  font-size: {{ section.settings.tab_font_size }}px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.tab-icon-img {
  width: {{ section.settings.icon_size }}px;
  height: {{ section.settings.icon_size }}px;
  object-fit: contain;
}

.mb-tab-btn.active {
  background-color: {{ section.settings.accent_color }};
  border-color: {{ section.settings.accent_color }};
  color: #ffffff;
}

.mb-tab-btn:hover:not(.active) {
  border-color: {{ section.settings.accent_color }};
  color: {{ section.settings.accent_color }};
}

/* Grid Layout */
.mb-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: {{ section.settings.grid_gap }}px;
}

/* Card Styling */
.mb-card {
  background-color: {{ section.settings.card_bg }};
  border-radius: {{ section.settings.card_radius }}px;
  display: flex;
  padding: 20px;
  gap: 20px;
  align-items: center;
  border: 1px solid {{ section.settings.card_border_color }};
  transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
  cursor: pointer;
  box-shadow: {{ section.settings.card_shadow }};
}

.mb-card:hover {
  transform: translateY(-{{ section.settings.hover_lift }}px);
  border-color: {{ section.settings.accent_color }};
}

.mb-img-box {
  flex: 0 0 40%;
  aspect-ratio: 1 / 1;
  border-radius: 8px;
  overflow: hidden;
}

.mb-img-box img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.mb-card:hover .mb-img-box img {
  transform: scale(1.1);
}

.mb-content {
  flex: 1;
}

.mb-content h3 {
  margin: 0 0 8px;
  font-family: {{ section.settings.heading_font }};
  font-size: {{ section.settings.prod_title_size }}px;
  font-weight: 700;
  color: {{ section.settings.prod_title_color }};
}

.mb-desc {
  font-family: {{ section.settings.body_font }};
  font-size: {{ section.settings.prod_desc_size }}px;
  color: {{ section.settings.prod_desc_color }};
  line-height: 1.5;
  margin-bottom: 12px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.mb-price {
  font-family: {{ section.settings.body_font }};
  font-size: {{ section.settings.price_size }}px;
  font-weight: 700;
  color: {{ section.settings.price_color }};
  margin-bottom: 15px;
}

.mb-add-btn {
  background-color: {{ section.settings.accent_color }};
  color: #ffffff;
  border: none;
  padding: 12px 25px;
  border-radius: {{ section.settings.btn_radius }}px;
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  text-transform: uppercase;
  transition: all 0.3s ease;
}

.mb-add-btn:hover {
  background-color: {{ section.settings.btn_hover_bg }};
  transform: scale(1.05);
}

/* Animations */
.animate-fade { animation: mbFadeIn 1s ease forwards; }
.animate-slide { animation: mbSlideUp 1s ease forwards; }
.animate-zoom { animation: mbZoomIn 0.8s ease forwards; }

@keyframes mbFadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes mbSlideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
@keyframes mbZoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

/* Responsive */
@media (max-width: 991px) {
  .mb-grid { grid-template-columns: 1fr; }
  .mb-header h2 { font-size: 32px; }
}

@media (max-width: 600px) {
  .mb-card { flex-direction: column; text-align: center; }
  .mb-img-box { width: 100%; flex: none; }
  .mb-add-btn { width: 100%; }
}
{%- endstyle -%}

<section class="menu-board-{{ section.id }} animate-{{ section.settings.animation_type }}">
  <div class="mb-container">
    <div class="mb-header">
      <h2>{{ section.settings.heading }}</h2>
    </div>

    <!-- Tabs Area -->
    <div class="mb-tabs">
      <button class="mb-tab-btn active" onclick="filterMenu('all', this, '{{ section.id }}')">All</button>
      {%- for block in section.blocks -%}
        <button class="mb-tab-btn" onclick="filterMenu('cat-{{ block.id }}', this, '{{ section.id }}')" {{ block.shopify_attributes }}>
          {%- if block.settings.tab_icon != blank -%}
            <img src="{{ block.settings.tab_icon | image_url: width: 50 }}" class="tab-icon-img" alt="icon">
          {%- endif -%}
          {{ block.settings.tab_title | default: block.settings.collection.title }}
        </button>
      {%- endfor -%}
    </div>

    <!-- Product Grid Area -->
    <div class="mb-grid" id="grid-{{ section.id }}">
      {%- for block in section.blocks -%}
        {%- assign collection = collections[block.settings.collection] -%}
        {%- for product in collection.products -%}
          <div class="mb-card cat-{{ block.id }} all-items" onclick="window.location.href='{{ product.url }}'">
            <div class="mb-img-box">
              <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}" loading="lazy">
            </div>
            <div class="mb-content">
              <h3>{{ product.title }}</h3>
              <p class="mb-desc">{{ product.description | strip_html }}</p>
              <div class="mb-price">{{ product.price | money }}</div>
              <form method="post" action="/cart/add" onclick="event.stopPropagation()" onsubmit="addToCartMenuAjax(event, this)">
                <input type="hidden" name="id" value="{{ product.variants.first.id }}" />
                <button type="submit" class="mb-add-btn">Add To Cart</button>
              </form>
            </div>
          </div>
        {%- endfor -%}
      {%- endfor -%}
    </div>
  </div>
</section>

<script>
function filterMenu(catId, btn, sectionId) {
  const section = btn.closest('section');
  section.querySelectorAll('.mb-tab-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');

  const cards = section.querySelectorAll('.all-items');
  cards.forEach(card => {
    if (catId === 'all' || card.classList.contains(catId)) {
      card.style.display = 'flex';
    } else {
      card.style.display = 'none';
    }
  });
}

function addToCartMenuAjax(e, form) {
  e.preventDefault();
  const btn = form.querySelector('button');
  const originalText = btn.innerText;
  btn.innerText = "Adding...";
  btn.disabled = true;

  fetch('/cart/add.js', { method: 'POST', body: new FormData(form) })
  .then(response => response.json())
  .then(data => {
    fetch('/cart.js').then(res => res.json()).then(cart => {
      const countBadges = document.querySelectorAll('.cart-count-pro');
      countBadges.forEach(badge => {
        badge.innerText = cart.item_count;
        badge.style.display = 'flex';
      });
      btn.innerText = "Added!";
      setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 2000);
    });
  }).catch(err => { btn.innerText = "Error"; setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 2000); });
}
</script>

{% schema %}
{
  "name": "Butcher Menu Board Pro",
  "settings": [
    { "type": "header", "content": "Typography" },
    { "type": "select", "id": "heading_font", "label": "Heading Font Family", "options": [
        { "value": "'Oswald', sans-serif", "label": "Oswald" },
        { "value": "'Questrial', sans-serif", "label": "Questrial" },
        { "value": "'Poppins', sans-serif", "label": "Poppins" }
      ], "default": "'Oswald', sans-serif" },
    { "type": "select", "id": "body_font", "label": "Body Font Family", "options": [
        { "value": "'Poppins', sans-serif", "label": "Poppins" },
        { "value": "'Questrial', sans-serif", "label": "Questrial" },
        { "value": "'Inter', sans-serif", "label": "Inter" }
      ], "default": "'Poppins', sans-serif" },
    { "type": "header", "content": "Section Heading" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Our Menu Board" },
    { "type": "range", "id": "title_size", "label": "Heading Font Size", "min": 20, "max": 80, "step": 1, "default": 48 },
    { "type": "color", "id": "title_color", "label": "Heading Color", "default": "#ffffff" },
    { "type": "select", "id": "heading_align", "label": "Heading Alignment", "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ], "default": "center" },
    { "type": "range", "id": "heading_weight", "label": "Font Weight", "min": 400, "max": 900, "step": 100, "default": 800 },
    { "type": "range", "id": "heading_spacing", "label": "Letter Spacing", "min": 0, "max": 10, "step": 1, "default": 1 },
    { "type": "range", "id": "heading_margin", "label": "Margin Bottom", "min": 0, "max": 100, "step": 5, "default": 40 },
    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "bg_color", "label": "Background", "default": "#000000" },
    { "type": "color", "id": "text_color", "label": "General Text Color", "default": "#ffffff" },
    { "type": "color", "id": "accent_color", "label": "Accent / Active Color", "default": "#d32f2f" },
    { "type": "header", "content": "Tabs Style" },
    { "type": "range", "id": "tab_font_size", "label": "Tab Font Size", "min": 12, "max": 24, "default": 14 },
    { "type": "color", "id": "tab_text_color", "label": "Tab Text", "default": "#ffffff" },
    { "type": "color", "id": "tab_border_color", "label": "Tab Border", "default": "#333333" },
    { "type": "range", "id": "tab_radius", "label": "Tab Radius", "min": 0, "max": 50, "default": 8 },
    { "type": "range", "id": "tab_gap", "label": "Gap Between Tabs", "min": 5, "max": 30, "default": 12 },
    { "type": "range", "id": "icon_size", "label": "Tab Icon Size", "min": 10, "max": 40, "default": 20 },
    { "type": "header", "content": "Card Style" },
    { "type": "color", "id": "card_bg", "label": "Card Background", "default": "#0a0a0a" },
    { "type": "color", "id": "card_border_color", "label": "Card Border", "default": "#1a1a1a" },
    { "type": "range", "id": "card_radius", "label": "Card Radius", "min": 0, "max": 30, "default": 12 },
    { "type": "text", "id": "card_shadow", "label": "Card Shadow CSS", "default": "0 10px 30px rgba(0,0,0,0.3)" },
    { "type": "range", "id": "hover_lift", "label": "Hover Lift Animation (px)", "min": 0, "max": 20, "default": 8 },
    { "type": "range", "id": "grid_gap", "label": "Grid Gap", "min": 10, "max": 50, "default": 25 },
    { "type": "header", "content": "Product Content" },
    { "type": "color", "id": "prod_title_color", "label": "Product Title", "default": "#ffffff" },
    { "type": "range", "id": "prod_title_size", "label": "Title Size", "min": 16, "max": 30, "default": 22 },
    { "type": "color", "id": "prod_desc_color", "label": "Description", "default": "#bbbbbb" },
    { "type": "range", "id": "prod_desc_size", "label": "Desc Size", "min": 10, "max": 18, "default": 13 },
    { "type": "color", "id": "price_color", "label": "Price Color", "default": "#ffffff" },
    { "type": "range", "id": "price_size", "label": "Price Size", "min": 14, "max": 24, "default": 18 },
    { "type": "range", "id": "btn_radius", "label": "Button Radius", "min": 0, "max": 50, "default": 6 },
    { "type": "color", "id": "btn_hover_bg", "label": "Button Hover Background", "default": "#a01a1a" },
    { "type": "header", "content": "Layout & Animation" },
    { "type": "select", "id": "animation_type", "label": "Entrance Animation", "options": [
        { "value": "none", "label": "None" },
        { "value": "fade", "label": "Fade In" },
        { "value": "slide", "label": "Slide Up" },
        { "value": "zoom", "label": "Zoom In" }
      ], "default": "fade" },
    { "type": "range", "id": "container_width", "label": "Max Width", "min": 1000, "max": 1600, "step": 10, "default": 1200 },
    { "type": "range", "id": "padding_top", "label": "Padding Top", "min": 0, "max": 150, "step": 5, "default": 80 },
    { "type": "range", "id": "padding_bottom", "label": "Padding Bottom", "min": 0, "max": 150, "step": 5, "default": 80 }
  ],
  "blocks": [
    {
      "type": "collection_group",
      "name": "Category Tab",
      "settings": [
        { "type": "text", "id": "tab_title", "label": "Tab Label (Optional)" },
        { "type": "image_picker", "id": "tab_icon", "label": "Category Icon (Upload Image)" },
        { "type": "collection", "id": "collection", "label": "Select Collection" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Butcher Menu Board Pro"
    }
  ]
}
{% endschema %}