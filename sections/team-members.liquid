{%- style -%}
  .section-{{ section.id }} {
    --primary-red: {{ section.settings.accent_color }};
    --text-dark: {{ section.settings.text_color_heading }};
    --text-muted: {{ section.settings.text_color_sub }};
    background-color: {{ section.settings.bg_color }};
    padding: 80px 0;
    font-family: 'Inter', sans-serif;
    overflow: hidden;
  }

  .container-team {
    max-width: 1240px;
    margin: 0 auto;
    padding: 0 20px;
    text-align: center;
  }

  .team-header { margin-bottom: 40px; }

  .team-title {
    font-family: 'Oswald', sans-serif;
    font-size: clamp(32px, 5vw, 52px);
    font-weight: 600;
    color: var(--text-dark);
    margin-bottom: 10px;
    text-transform: uppercase;
  }

  .team-subtitle {
    font-size: 16px;
    color: var(--text-muted);
    line-height: 1.5;
    max-width: 600px;
    margin: 0 auto;
  }

  .team-slider-outer {
    position: relative;
    margin: 0 -12px;
    min-height: 300px; 
  }

  .team-slider-container { overflow: hidden; cursor: grab; padding: 10px 0; }

  .team-track {
    display: flex;
    transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1);
    will-change: transform;
  }

  .team-card {
    flex: 0 0 33.333%;
    padding: 12px;
    box-sizing: border-box;
    display: flex;
  }

  .member-image-box {
    width: 100%;
    height: 400px;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 12px 25px rgba(0,0,0,0.08);
    transition: transform 0.4s ease;
    background-color: #f5f5f5;
  }

  .member-image-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform 0.5s ease;
  }

  .team-card:hover .member-image-box { transform: translateY(-8px); }
  .team-card:hover img { transform: scale(1.05); }

  .team-dots {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 30px 0;
    min-height: 10px;
  }

  .t-dot {
    width: 8px;
    height: 8px;
    background-color: #ddd;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.3s;
  }

  .t-dot.active {
    background-color: var(--primary-red);
    width: 24px;
    border-radius: 10px;
  }

  .team-nav {
    display: flex;
    justify-content: center;
    gap: 15px;
  }

  .t-nav-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #ffffff;
    border: 2px solid var(--primary-red);
    color: var(--primary-red);
    transition: all 0.3s ease;
  }

  .t-nav-btn:hover {
    background-color: var(--primary-red);
    color: #ffffff;
  }

  @media (max-width: 1024px) { .team-card { flex: 0 0 50%; } }
  @media (max-width: 768px) { 
    .team-card { flex: 0 0 100%; } 
    .member-image-box { height: 350px; } 
    .section-{{ section.id }} { padding: 50px 0; }
  }
{%- endstyle -%}

<section class="section-{{ section.id }} team-members-section" data-section-id="{{ section.id }}">
  <div class="container-team">
    
    <div class="team-header">
      <h2 class="team-title">{{ section.settings.heading }}</h2>
      <div class="team-subtitle">{{ section.settings.subheading }}</div>
    </div>

    <div class="team-slider-outer">
      <div class="team-slider-container" id="teamSliderWrapper-{{ section.id }}">
        <div class="team-track" id="teamTrack-{{ section.id }}">
          
          {%- if section.blocks.size > 0 -%}
            {%- for block in section.blocks -%}
              <div class="team-card" {{ block.shopify_attributes }}>
                <div class="member-image-box">
                  {%- if block.settings.image != blank -%}
                    <img src="{{ block.settings.image | img_url: '600x800', crop: 'center' }}" alt="Team Member" loading="lazy">
                  {%- else -%}
                    <img src="https://images.unsplash.com/photo-1594179047519-f347310d3322?q=80&w=600&auto=format&fit=crop" alt="Placeholder">
                  {%- endif -%}
                </div>
              </div>
            {%- endfor -%}
          {%- else -%}
            {%- comment -%} Placeholder cards dikhane ke liye agar blocks khali hain {%- endcomment -%}
            {%- for i in (1..3) -%}
              <div class="team-card">
                <div class="member-image-box">
                  <img src="https://images.unsplash.com/photo-1583394238711-b40f5f63bc1d?q=80&w=600&auto=format&fit=crop" alt="Meat Expert Demo">
                </div>
              </div>
            {%- endfor -%}
          {%- endif -%}

        </div>
      </div>
    </div>

    <div class="team-dots" id="teamDots-{{ section.id }}"></div>

    <div class="team-nav">
      <button class="t-nav-btn" onclick="window.teamSlider_{{ section.id | replace: '-', '_' }}.move(-1)">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>
      </button>
      <button class="t-nav-btn" onclick="window.teamSlider_{{ section.id | replace: '-', '_' }}.move(1)">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>
      </button>
    </div>

  </div>
</section>

<script>
(function() {
  class TeamSlider {
    constructor(id) {
      this.id = id;
      this.track = document.getElementById(`teamTrack-${id}`);
      this.dotsBox = document.getElementById(`teamDots-${id}`);
      this.index = 0;
      if (this.track) this.init();
    }

    getVisible() {
      if (window.innerWidth <= 768) return 1;
      if (window.innerWidth <= 1024) return 2;
      return 3;
    }

    init() {
      this.setupDots();
      this.update();
      window.addEventListener('resize', () => { 
        this.index = 0; 
        this.setupDots(); 
        this.update(); 
      });
    }

    setupDots() {
      const cards = this.track.querySelectorAll('.team-card');
      const dotCount = Math.max(0, cards.length - this.getVisible() + 1);
      if (!this.dotsBox) return;
      this.dotsBox.innerHTML = '';
      for (let i = 0; i < dotCount; i++) {
        const dot = document.createElement('span');
        dot.className = `t-dot ${i === this.index ? 'active' : ''}`;
        dot.onclick = () => { this.index = i; this.update(); };
        this.dotsBox.appendChild(dot);
      }
    }

    move(dir) {
      const cards = this.track.querySelectorAll('.team-card');
      const max = Math.max(0, cards.length - this.getVisible());
      this.index += dir;
      if (this.index < 0) this.index = max;
      else if (this.index > max) this.index = 0;
      this.update();
    }

    update() {
      const cards = this.track.querySelectorAll('.team-card');
      if (cards.length === 0) return;
      const width = cards[0].offsetWidth;
      this.track.style.transform = `translateX(-${this.index * width}px)`;
      const dots = this.dotsBox.querySelectorAll('.t-dot');
      dots.forEach((dot, i) => dot.classList.toggle('active', i === this.index));
    }
  }

  function initSection() {
    window.teamSlider_{{ section.id | replace: '-', '_' }} = new TeamSlider('{{ section.id }}');
  }

  if (document.readyState === 'complete') {
    initSection();
  } else {
    window.addEventListener('load', initSection);
  }

  document.addEventListener('shopify:section:load', (e) => {
    if (e.detail.sectionId === '{{ section.id }}') initSection();
  });
})();
</script>

{% schema %}
{
  "name": "Meet Our Team",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Meet Our Team Members" },
    { "type": "richtext", "id": "subheading", "label": "Sub-heading", "default": "<p>Every cut of meat is carefully selected, hygienically processed.</p>" },
    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "bg_color", "label": "Background Color", "default": "#ffffff" },
    { "type": "color", "id": "accent_color", "label": "Accent Color (Red)", "default": "#d32f2f" },
    { "type": "color", "id": "text_color_heading", "label": "Heading Color", "default": "#1a1a1a" },
    { "type": "color", "id": "text_color_sub", "label": "Sub-heading Color", "default": "#555555" }
  ],
  "blocks": [
    {
      "type": "member",
      "name": "Team Member",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Member Image" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Meet Our Team",
      "blocks": [ { "type": "member" }, { "type": "member" }, { "type": "member" } ]
    }
  ]
}
{% endschema %}